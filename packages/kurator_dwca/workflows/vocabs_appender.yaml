# This workflow reads a text file and outputs distinct values of a given field.
#
# Example command-line usage:
# kurator -f workflows/vocabs_appender.yaml -p p=fullpath -p v=../../data/eight_specimen_records.csv -p a=../../vocabularies -p t='day'

imports:

- classpath:/org/kurator/akka/actors.yaml
- classpath:/org/kurator/validation/actors/dwca/actors.yaml

components:

- id: WorkflowPrimer
  type: PythonActor
  properties:
    script: workflow_primer.py
    onStart: workflow_primer
    parameters:
      outputTypeIsInputType: true

- id: VocabsAppender
  type: PythonActor
  properties:
    script: vocabs_appender.py
    onData: vocabs_appender
    listensTo:
      - !ref WorkflowPrimer
    parameters:
      outputTypeIsInputType: true

- id: VocabsAppenderWorkflow
  type: Workflow
  properties:
    actors:
      - !ref WorkflowPrimer
      - !ref VocabsAppender
    parameters:
      p:
        actor: !ref WorkflowPrimer
        parameter: wfparameter
      v:
        actor: !ref WorkflowPrimer
        parameter: wfvalue
      a:
        actor: !ref VocabsAppender
        parameter: vocabs_path
      t:
        actor: !ref VocabsAppender
        parameter: termlist
