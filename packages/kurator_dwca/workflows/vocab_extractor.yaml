# This workflow reads a text file and outputs distinct values of a given field.
#
# Example command-line usage:
# kurator -f workflows/vocab_extractor.yaml -p p=fullpath -p v=../../data/eight_specimen_records.csv -p t=country

imports:

- classpath:/org/kurator/akka/actors.yaml
- classpath:/org/kurator/validation/actors/dwca/actors.yaml

components:

- id: WorkflowPrimer
  type: PythonActor
  properties:
    script: workflow_primer.py
    onStart: workflow_primer
    parameters:
      outputTypeIsInputType: true

- id: VocabExtractor
  type: PythonActor
  properties:
    script: vocab_extractor.py
    onData: vocab_extractor
    listensTo:
      - !ref WorkflowPrimer
    parameters:
      outputTypeIsInputType: true

- id: VocabExtractorWorkflow
  type: Workflow
  properties:
    actors:
      - !ref WorkflowPrimer
      - !ref VocabExtractor
    parameters:
      p:
        actor: !ref WorkflowPrimer
        parameter: wfparameter
      v:
        actor: !ref WorkflowPrimer
        parameter: wfvalue
      t:
        actor: !ref VocabExtractor
        parameter: termname
